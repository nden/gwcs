[tox]
envlist= py38,style,bandit

[testenv]
deps=
    dev: -rrequirements-dev.txt
extras= test
# astropy will complain if the home directory is missing
passenv= HOME
commands=
    pytest

[testenv:style]
deps=
    flake8
commands=
    flake8 --count

[testenv:coverage]
deps=
    codecov
    coverage
commands=
    coverage run --source=gwcs --rcfile={toxinidir}/gwcs/tests/coveragerc \
                 -m pytest --remote-data --open-files
    coverage report -m
    codecov -e TOXENV
passenv= HOME GITHUB_* TOXENV CI CODECOV_* DISPLAY    

[testenv:bandit]
deps=
    bandit
commands=
    bandit -r -ll -c .bandit.yaml gwcs

[testenv:build-docs]
extras= docs
commands=
    sphinx-build -W docs build/docs
